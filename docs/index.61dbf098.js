function t(t){return t&&t.__esModule?t.default:t}var e={};const r=BigInt(0),n=BigInt(1),i=BigInt(2),o=BigInt(255),f={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:i**o-BigInt(19),n:i**BigInt(252)+BigInt("27742317777372353535851937790883648493"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")},s=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),a=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),u=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),h=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),c=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class l{static fromAffine(t){if(!(t instanceof y))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(y.ZERO)?l.ZERO:new l(t.x,t.y,n,x(t.x*t.y))}static toAffineBatch(t){const e=function(t,e=f.P){const i=t.length,o=new Array(i);let s=n;for(let n=0;n<i;n++)t[n]!==r&&(o[n]=s,s=x(s*t[n],e));s=I(s,e);for(let n=i-1;n>=0;n--){if(t[n]===r)continue;let i=x(s*t[n],e);t[n]=x(s*o[n],e),s=i}return t}(t.map((t=>t.z)));return t.map(((t,r)=>t.toAffine(e[r])))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}static fromRistrettoHash(t){if("string"==typeof t&&(t=m(t)),64!==t.length)throw new Error("Invalid ristretto hash, need 64 bytes");const e=A(t.slice(0,32)),r=this.calcElligatorRistrettoMap(e),n=A(t.slice(32,64)),i=this.calcElligatorRistrettoMap(n);return r.add(i)}static calcElligatorRistrettoMap(t){const{d:e}=f,r=x(s*t*t),i=x((r+n)*h);let o=BigInt(-1);const u=x((o-e*r)*x(r+e));let{isValid:p,value:y}=S(i,u),g=x(y*t);v(g)||(g=x(-g)),p||(y=g),p||(o=r);const d=x(o*(r-n)*c-u),w=y*y,m=x((y+y)*u),b=x(d*a),E=x(n-w),B=x(n+w);return new l(x(m*B),x(E*b),x(b*B),x(m*E))}static fromRistrettoBytes(t){if("string"==typeof t&&(t=m(t)),32!==t.length)throw new Error("Invalid ristretto hash, need 64 bytes");const{a:e,d:i}=f,o="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=A(t);if(!function(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(E(s,32),t)||v(s))throw new Error(o);const a=x(s*s),u=x(n+e*a),h=x(n-e*a),c=x(u*u),p=x(h*h),y=x(e*i*c-p),{isValid:g,value:d}=R(x(y*p)),w=x(d*h),b=x(d*w*y);let B=x((s+s)*w);v(B)&&(B=x(-B));const I=x(u*b),U=x(B*I);if(!g||v(U)||I===r)throw new Error(o);return new l(B,I,n,U)}toRistrettoBytes(){let{x:t,y:e,z:r,t:n}=this;const o=x(x(r+e)*x(r-e)),f=x(t*e),{value:a}=R(x(o*f**i)),h=x(a*o),c=x(a*f),l=x(h*c*n);let p;if(v(n*l)){let r=x(e*s),n=x(t*s);t=r,e=n,p=x(h*u)}else p=c;v(t*l)&&(e=x(-e));let y=x((r-e)*p);return v(y)&&(y=x(-y)),E(y,32)}equals(t){const e=t;return x(this.t*e.z)===x(e.t*this.z)}negate(){return new l(x(-this.x),this.y,this.z,x(-this.t))}double(){const t=this.x,e=this.y,r=this.z,{a:n}=f,o=x(t**i),s=x(e**i),a=x(i*r**i),u=x(n*o),h=x((t+e)**i-o-s),c=x(u+s),p=x(c-a),y=x(u-s),g=x(h*p),d=x(c*y),w=x(h*y),m=x(p*c);return new l(g,d,m,w)}add(t){const e=this.x,n=this.y,o=this.z,f=this.t,s=t.x,a=t.y,u=t.z,h=t.t,c=x((n-e)*(a+s)),p=x((n+e)*(a-s)),y=x(p-c);if(y===r)return this.double();const g=x(o*i*h),d=x(f*i*u),w=x(d+g),m=x(p+c),b=x(d-g),E=x(w*y),v=x(m*b),B=x(w*b),A=x(y*m);return new l(E,v,A,B)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let e=k(t);if(e===n)return this;let i=l.ZERO,o=this;for(;e>r;)e&n&&(i=i.add(o)),o=o.double(),e>>=n;return i}precomputeWindow(t){const e=256/t+1;let r=[],n=this,i=n;for(let o=0;o<e;o++){i=n,r.push(i);for(let e=1;e<2**(t-1);e++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(t,e){!e&&this.equals(l.BASE)&&(e=y.BASE);const r=e&&e._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=e&&p.get(e);i||(i=this.precomputeWindow(r),e&&1!==r&&(i=l.normalizeZ(i),p.set(e,i)));let o=l.ZERO,f=l.ZERO;const s=256/r+1,a=2**(r-1),u=BigInt(2**r-1),h=2**r,c=BigInt(r);for(let e=0;e<s;e++){const r=e*a;let s=Number(t&u);if(t>>=c,s>a&&(s-=h,t+=n),0===s){let t=i[r];e%2&&(t=t.negate()),f=f.add(t)}else{let t=i[r+Math.abs(s)-1];s<0&&(t=t.negate()),o=o.add(t)}}return[o,f]}multiply(t,e){const r=k(t);return l.normalizeZ(this.wNAF(r,e))[0]}toAffine(t=I(this.z)){const e=x(this.x*t),r=x(this.y*t);return new y(e,r)}constructor(t,e,r,n){this.x=t,this.y=e,this.z=r,this.t=n}}l.BASE=new l(f.Gx,f.Gy,n,x(f.Gx*f.Gy)),l.ZERO=new l(r,n,n,r);const p=new WeakMap;class y{_setWindowSize(t){this._WINDOW_SIZE=t,p.delete(this)}static fromHex(t){const{d:e,P:r}=f,i=t instanceof Uint8Array?t:m(t);if(32!==i.length)throw new Error("Point.fromHex: expected 32 bytes");const o=i[31],s=-129&o,a=0!=(128&o),u=B(Uint8Array.from(Array.from(i.slice(0,31)).concat(s)));if(u>=r)throw new Error("Point.fromHex expects hex <= Fp");const h=x(u*u),c=x(h-n),l=x(e*h+n);let{isValid:p,value:g}=S(c,l);if(!p)throw new Error("Point.fromHex: invalid y coordinate");return a!==((g&n)===n)&&(g=x(-g)),new y(g,u)}static async fromPrivateKey(t){const e=await z(t);return y.BASE.multiply(T(e))}toRawBytes(){const t=b(this.y),e=new Uint8Array(32);for(let r=t.length-2,n=0;n<32&&r>=0;r-=2,n++)e[n]=w(t[r]+t[r+1]);const r=this.x&n?128:0;return e[31]|=r,e}toHex(){return d(this.toRawBytes())}toX25519(){return x((n+this.y)*I(n-this.y))}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new y(x(-this.x),this.y)}add(t){return l.fromAffine(this).add(l.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return l.fromAffine(this).multiply(t,this).toAffine()}constructor(t,e){this.x=t,this.y=e}}y.BASE=new y(f.Gx,f.Gy),y.ZERO=new y(r,n);const g=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function d(t){let e="";for(let r=0;r<t.length;r++)e+=g[t[r]];return e}function w(t){const e=Number.parseInt(t,16);if(Number.isNaN(e))throw new Error("Invalid byte sequence");return e}function m(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){const n=2*r;e[r]=w(t.slice(n,n+2))}return e}function b(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function E(t,e=32){return m(b(t).padStart(2*e,"0")).reverse()}function v(t){return(x(t)&n)===n}function B(t){let e=r;for(let r=0;r<t.length;r++)e+=BigInt(t[r])<<BigInt(8)*BigInt(r);return e}function A(t){return x(B(t)&i**o-n)}function x(t,e=f.P){const n=t%e;return n>=r?n:e+n}function I(t,e=f.P){if(t===r||e<=r)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let i=x(t,e),o=e,s=r,a=n,u=n,h=r;for(;i!==r;){const t=o/i,e=o%i,r=s-u*t,n=a-h*t;o=i,i=e,s=u,a=h,u=r,h=n}if(o!==n)throw new Error("invert: does not exist");return x(s,e)}function U(t,e){const{P:n}=f;let i=t;for(;e-- >r;)i*=i,i%=n;return i}function S(t,e){const r=x(e*e*e),o=x(r*r*e);let a=x(t*r*function(t){const{P:e}=f,[r,o,s,a,u]=[5,10,20,40,80].map((t=>BigInt(t))),h=t*t%e*t%e,c=U(h,i)*h%e,l=U(c,n)*t%e,p=U(l,r)*l%e,y=U(p,o)*p%e,g=U(y,s)*y%e,d=U(g,a)*g%e,w=U(d,u)*d%e,m=U(w,u)*d%e,b=U(m,o)*p%e;return U(b,i)*t%e}(t*o));const u=x(e*a*a),h=a,c=x(a*s),l=u===t,p=u===x(-t),y=u===x(-t*s);return l&&(a=h),(p||y)&&(a=c),v(a)&&(a=x(-a)),{isValid:l||p,value:a}}function R(t){return S(n,t)}function T(t){const e=t.slice(0,32);return e[0]&=248,e[31]&=127,e[31]|=64,x(B(e),f.n)}function P(t){return 0<t&&t<f.n}const O=i**BigInt(256)-n;async function z(t){return await N.sha512(function(t){let e,r="Expected 32 bytes of private key";if("bigint"==typeof t||"number"==typeof t&&Number.isSafeInteger(t)){let n=BigInt(t);if(n<0||n>O)throw new Error(r);e=m(n.toString(16).padStart(64,"0"))}else if("string"==typeof t){if(64!==t.length)throw new Error(r);e=m(t)}else{if(!(t instanceof Uint8Array))throw new TypeError("Expected valid private key");if(32!==t.length)throw new Error(r);e=t}return e}(t))}function k(t){if("number"==typeof t&&t>0&&Number.isSafeInteger(t))return BigInt(t);if("bigint"==typeof t&&P(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}y.BASE._setWindowSize(8);const C={node:t(e),web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},N={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:d,randomBytes:(t=32)=>{if(C.web)return C.web.getRandomValues(new Uint8Array(t));if(C.node){const{randomBytes:e}=C.node;return new Uint8Array(e(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>N.randomBytes(32),sha512:async t=>{if(C.web){const e=await C.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(C.node)return Uint8Array.from(C.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(t=8,e=y.BASE){const r=e.equals(y.BASE)?e:new y(e.x,e.y);return r._setWindowSize(t),r.multiply(n),r}},L=BigInt(0),H=BigInt(1),M=BigInt(2),Z=BigInt(3),_=BigInt(8),$=M**BigInt(256),W={a:L,b:BigInt(7),P:$-M**BigInt(32)-BigInt(977),n:$-BigInt("432420386565659656852420866394968145599"),h:H,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function D(t){const{a:e,b:r}=W;return at(t**Z+e*t+r)}const K=W.a===L;class V{static fromAffine(t){if(!(t instanceof G))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new V(t.x,t.y,H)}static toAffineBatch(t){const e=function(t,e=W.P){const r=t.length,n=new Array(r);let i=H;for(let o=0;o<r;o++)t[o]!==L&&(n[o]=i,i=at(i*t[o],e));i=ht(i,e);for(let o=r-1;o>=0;o--){if(t[o]===L)continue;const r=at(i*t[o],e);t[o]=at(i*n[o],e),i=r}return t}(t.map((t=>t.z)));return t.map(((t,r)=>t.toAffine(e[r])))}static normalizeZ(t){return V.toAffineBatch(t).map(V.fromAffine)}equals(t){const e=this,r=t,n=at(e.z*e.z),i=at(e.z*n),o=at(r.z*r.z),f=at(r.z*o);return at(e.x*o)===at(n*r.x)&&at(e.y*f)===at(i*r.y)}negate(){return new V(this.x,at(-this.y),this.z)}double(){const t=this.x,e=this.y,r=this.z,n=at(t**M),i=at(e**M),o=at(i**M),f=at(M*(at(at((t+i)**M))-n-o)),s=at(Z*n),a=at(s**M),u=at(a-M*f),h=at(s*(f-u)-_*o),c=at(M*e*r);return new V(u,h,c)}add(t){if(!(t instanceof V))throw new TypeError("JacobianPoint#add: expected JacobianPoint");const e=this.x,r=this.y,n=this.z,i=t.x,o=t.y,f=t.z;if(i===L||o===L)return this;if(e===L||r===L)return t;const s=at(n**M),a=at(f**M),u=at(e*a),h=at(i*s),c=at(r*f*a),l=at(at(o*n)*s),p=at(h-u),y=at(l-c);if(p===L)return y===L?this.double():V.ZERO;const g=at(p**M),d=at(p*g),w=at(u*g),m=at(y**M-d-M*w),b=at(y*(w-m)-c*d),E=at(n*f*p);return new V(m,b,E)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let e=st(t);if(!K){let t=V.ZERO,r=this;for(;e>L;)e&H&&(t=t.add(r)),r=r.double(),e>>=H;return t}let{k1neg:r,k1:n,k2neg:i,k2:o}=pt(e),f=V.ZERO,s=V.ZERO,a=this;for(;n>L||o>L;)n&H&&(f=f.add(a)),o&H&&(s=s.add(a)),a=a.double(),n>>=H,o>>=H;return r&&(f=f.negate()),i&&(s=s.negate()),s=new V(at(s.x*W.beta),s.y,s.z),f.add(s)}precomputeWindow(t){const e=K?128/t+1:256/t+1;let r=[],n=this,i=n;for(let o=0;o<e;o++){i=n,r.push(i);for(let e=1;e<2**(t-1);e++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(t,e){!e&&this.equals(V.BASE)&&(e=G.BASE);const r=e&&e._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=e&&j.get(e);n||(n=this.precomputeWindow(r),e&&1!==r&&(n=V.normalizeZ(n),j.set(e,n)));let i=V.ZERO,o=V.ZERO;const f=K?128/r+1:256/r+1,s=2**(r-1),a=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let e=0;e<f;e++){const r=e*s;let f=Number(t&a);if(t>>=h,f>s&&(f-=u,t+=H),0===f){let t=n[r];e%2&&(t=t.negate()),o=o.add(t)}else{let t=n[r+Math.abs(f)-1];f<0&&(t=t.negate()),i=i.add(t)}}return{p:i,f:o}}multiply(t,e){let r,n,i=st(t);if(K){let{k1neg:t,k1:o,k2neg:f,k2:s}=pt(i),{p:a,f:u}=this.wNAF(o,e),{p:h,f:c}=this.wNAF(s,e);t&&(a=a.negate()),f&&(h=h.negate()),h=new V(at(h.x*W.beta),h.y,h.z),r=a.add(h),n=u.add(c)}else{let{p:t,f:o}=this.wNAF(i,e);r=t,n=o}return V.normalizeZ([r,n])[0]}toAffine(t=ht(this.z)){const e=t**M,r=at(this.x*e),n=at(this.y*e*t);return new G(r,n)}constructor(t,e,r){this.x=t,this.y=e,this.z=r}}V.BASE=new V(W.Gx,W.Gy,H),V.ZERO=new V(L,H,L);const j=new WeakMap;class G{_setWindowSize(t){this._WINDOW_SIZE=t,j.delete(this)}static fromCompressedHex(t){const e=32===t.length,r=ft(e?t:t.slice(1));let n=function(t){const{P:e}=W,r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),f=BigInt(44),s=BigInt(88),a=t*t*t%e,u=a*a*t%e,h=ut(u,Z)*u%e,c=ut(h,Z)*u%e,l=ut(c,M)*a%e,p=ut(l,n)*l%e,y=ut(p,i)*p%e,g=ut(y,f)*y%e,d=ut(g,s)*g%e,w=ut(d,f)*y%e,m=ut(w,Z)*u%e,b=ut(m,o)*p%e,E=ut(b,r)*a%e;return ut(E,M)}(D(r));const i=(n&H)===H;if(e)i&&(n=at(-n));else{1==(1&t[0])!==i&&(n=at(-n))}const o=new G(r,n);return o.assertValidity(),o}static fromUncompressedHex(t){const e=ft(t.slice(1,33)),r=ft(t.slice(33)),n=new G(e,r);return n.assertValidity(),n}static fromHex(t){const e=ot(t),r=e[0];if(32===e.length||33===e.length&&(2===r||3===r))return this.fromCompressedHex(e);if(65===e.length&&4===r)return this.fromUncompressedHex(e);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${e.length}`)}static fromPrivateKey(t){return G.BASE.multiply(gt(t))}static fromSignature(t,e,r){let n=t instanceof Uint8Array?ft(t):rt(t);const i=dt(e),{r:o,s:f}=i;if(0!==r&&1!==r)throw new Error("Cannot recover signature: invalid recovery bit");const s=2+(1&r),a=G.fromHex(`0${s}${tt(o)}`),u=V.fromAffine(a).multiplyUnsafe(f),h=V.BASE.multiply(n),c=ht(o,W.n),l=u.subtract(h).multiplyUnsafe(c).toAffine();return l.assertValidity(),l}toRawBytes(t=!1){return it(this.toHex(t))}toHex(t=!1){const e=tt(this.x);return t?`${this.y&H?"03":"02"}${e}`:`04${e}${tt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{P:e}=W,{x:r,y:n}=this;if(r===L||n===L||r>=e||n>=e)throw new Error(t);if((at(n*n)-D(r))%e!==L)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new G(this.x,at(-this.y))}double(){return V.fromAffine(this).double().toAffine()}add(t){return V.fromAffine(this).add(V.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return V.fromAffine(this).multiply(t,this).toAffine()}constructor(t,e){this.x=t,this.y=e}}function F(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function q(t){if(t.length<2||2!==t[0])throw new Error(`Invalid signature integer tag: ${Q(t)}`);const e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ft(r),left:t.subarray(e+2)}}G.BASE=new G(W.Gx,W.Gy),G.ZERO=new G(L,L);class Y{static fromCompact(t){const e=t instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof t&&!e)throw new TypeError(`${r}: Expected string or Uint8Array`);const n=e?Q(t):t;if(128!==n.length)throw new Error(`${r}: Expected 64-byte hex`);return new Y(rt(n.slice(0,64)),rt(n.slice(64,128)))}static fromDER(t){const e=t instanceof Uint8Array;if("string"!=typeof t&&!e)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:r,s:n}=function(t){if(t.length<2||48!=t[0])throw new Error(`Invalid signature tag: ${Q(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");const{data:e,left:r}=q(t.subarray(2)),{data:n,left:i}=q(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Q(i)}`);return{r:e,s:n}}(e?t:it(t));return new Y(r,n)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:e}=this;if(!yt(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!yt(e))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=W.n>>H;return this.s>t}normalizeS(){return this.hasHighS()?new Y(this.r,W.n-this.s):this}toDERRawBytes(t=!1){return it(this.toDERHex(t))}toDERHex(t=!1){const e=F(et(this.s));if(t)return e;const r=F(et(this.r)),n=et(r.length/2),i=et(e.length/2);return`30${et(r.length/2+e.length/2+4)}02${n}${r}02${i}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return it(this.toCompactHex())}toCompactHex(){return tt(this.r)+tt(this.s)}constructor(t,e){this.r=t,this.s=e,this.assertValidity()}}function J(...t){if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}const X=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Q(t){let e="";for(let r=0;r<t.length;r++)e+=X[t[r]];return e}function tt(t){if(t>$)throw new Error("pad64: invalid number");return t.toString(16).padStart(64,"0")}function et(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function rt(t){if("string"!=typeof t)throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function nt(t){if(2!==t.length)throw new Error("Invalid byte sequence");const e=Number.parseInt(t,16);if(Number.isNaN(e))throw new Error("Invalid byte sequence");return e}function it(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){const n=2*r;e[r]=nt(t.slice(n,n+2))}return e}function ot(t){return t instanceof Uint8Array?t:it(t)}function ft(t){return rt(Q(t))}function st(t){if("number"==typeof t&&t>0&&Number.isSafeInteger(t))return BigInt(t);if("bigint"==typeof t&&yt(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function at(t,e=W.P){const r=t%e;return r>=0?r:e+r}function ut(t,e){const{P:r}=W;let n=t;for(;e-- >L;)n*=n,n%=r;return n}function ht(t,e=W.P){if(t===L||e<=L)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=at(t,e),n=e,i=L,o=H,f=H,s=L;for(;r!==L;){const t=n/r,e=n%r,a=i-f*t,u=o-s*t;n=r,r=e,i=f,o=s,f=a,s=u}if(n!==H)throw new Error("invert: does not exist");return at(i,e)}const ct=(t,e)=>(t+e/M)/e,lt=M**BigInt(128);function pt(t){const{n:e}=W,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-H*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,f=ct(o*t,e),s=ct(-n*t,e);let a=at(t-f*r-s*i,e),u=at(-f*n-s*o,e);const h=a>lt,c=u>lt;if(h&&(a=e-a),c&&(u=e-u),a>lt||u>lt)throw new Error("splitScalarEndo: Endomorphism failed");return{k1neg:h,k1:a,k2neg:c,k2:u}}function yt(t){return 0<t&&t<W.n}function gt(t){let e;if("bigint"==typeof t)e=t;else if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if("string"==typeof t){if(64!==t.length)throw new Error("Expected 32 bytes of private key");e=rt(t)}else{if(!(t instanceof Uint8Array))throw new TypeError("Expected valid private key");if(32!==t.length)throw new Error("Expected 32 bytes of private key");e=ft(t)}if(!yt(e))throw new Error("Expected private key: 0 < key < n");return e}function dt(t){if(t instanceof Y)return t.assertValidity(),t;try{return Y.fromDER(t)}catch(e){return Y.fromCompact(t)}}G.BASE._setWindowSize(8);const wt={node:t(e),web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},mt={isValidPrivateKey(t){try{return gt(t),!0}catch(t){return!1}},randomBytes:(t=32)=>{if(wt.web)return wt.web.getRandomValues(new Uint8Array(t));if(wt.node){const{randomBytes:e}=wt.node;return new Uint8Array(e(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){const t=mt.randomBytes(32),e=ft(t);if(yt(e)&&e!==H)return t}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},bytesToHex:Q,sha256:async t=>{if(wt.web){const e=await wt.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}if(wt.node){const{createHash:e}=wt.node;return Uint8Array.from(e("sha256").update(t).digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(wt.web){const r=await wt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=J(...e),i=await wt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}if(wt.node){const{createHmac:r}=wt.node,n=r("sha256",t);for(const t of e)n.update(t);return Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=G.BASE){const r=e===G.BASE?e:new G(e.x,e.y);return r._setWindowSize(t),r.multiply(Z),r}};var bt,Et,vt;Et=function(t){var e,r,n=Pt(t),i=n[0],o=n[1],f=new Ut(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),s=0,a=o>0?i-4:i;for(r=0;r<a;r+=4)e=It[t.charCodeAt(r)]<<18|It[t.charCodeAt(r+1)]<<12|It[t.charCodeAt(r+2)]<<6|It[t.charCodeAt(r+3)],f[s++]=e>>16&255,f[s++]=e>>8&255,f[s++]=255&e;2===o&&(e=It[t.charCodeAt(r)]<<2|It[t.charCodeAt(r+1)]>>4,f[s++]=255&e);1===o&&(e=It[t.charCodeAt(r)]<<10|It[t.charCodeAt(r+1)]<<4|It[t.charCodeAt(r+2)]>>2,f[s++]=e>>8&255,f[s++]=255&e);return f},vt=function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,f=0,s=r-n;f<s;f+=o)i.push(Ot(t,f,f+o>s?s:f+o));1===n?(e=t[r-1],i.push(xt[e>>2]+xt[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(xt[e>>10]+xt[e>>4&63]+xt[e<<2&63]+"="));return i.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var Bt,At,xt=[],It=[],Ut="undefined"!=typeof Uint8Array?Uint8Array:Array,St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rt=0,Tt=St.length;Rt<Tt;++Rt)xt[Rt]=St[Rt],It[St.charCodeAt(Rt)]=Rt;function Pt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function Ot(t,e,r){for(var n,i,o=[],f=e;f<r;f+=3)n=(t[f]<<16&16711680)+(t[f+1]<<8&65280)+(255&t[f+2]),o.push(xt[(i=n)>>18&63]+xt[i>>12&63]+xt[i>>6&63]+xt[63&i]);return o.join("")}It["-".charCodeAt(0)]=62,It["_".charCodeAt(0)]=63,Bt=function(t,e,r,n,i){var o,f,s=8*i-n-1,a=(1<<s)-1,u=a>>1,h=-7,c=r?i-1:0,l=r?-1:1,p=t[e+c];for(c+=l,o=p&(1<<-h)-1,p>>=-h,h+=s;h>0;o=256*o+t[e+c],c+=l,h-=8);for(f=o&(1<<-h)-1,o>>=-h,h+=n;h>0;f=256*f+t[e+c],c+=l,h-=8);if(0===o)o=1-u;else{if(o===a)return f?NaN:1/0*(p?-1:1);f+=Math.pow(2,n),o-=u}return(p?-1:1)*f*Math.pow(2,o-n)},At=function(t,e,r,n,i,o){var f,s,a,u=8*o-i-1,h=(1<<u)-1,c=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,y=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,f=h):(f=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-f))<1&&(f--,a*=2),(e+=f+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(f++,a/=2),f+c>=h?(s=0,f=h):f+c>=1?(s=(e*a-1)*Math.pow(2,i),f+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),f=0));i>=8;t[r+p]=255&s,p+=y,s/=256,i-=8);for(f=f<<i|s,u+=i;u>0;t[r+p]=255&f,p+=y,f/=256,u-=8);t[r+p-y]|=128*g};var zt="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;bt=Ct;function kt(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,Ct.prototype),e}function Ct(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return Ht(t)}return Nt(t,e,r)}function Nt(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!Ct.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|$t(t,e),n=kt(r),i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(le(t,Uint8Array)){var e=new Uint8Array(t);return Zt(e.buffer,e.byteOffset,e.byteLength)}return Mt(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(le(t,ArrayBuffer)||t&&le(t.buffer,ArrayBuffer))return Zt(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(le(t,SharedArrayBuffer)||t&&le(t.buffer,SharedArrayBuffer)))return Zt(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return Ct.from(n,e,r);var i=function(t){if(Ct.isBuffer(t)){var e=0|_t(t.length),r=kt(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||pe(t.length)?kt(0):Mt(t);if("Buffer"===t.type&&Array.isArray(t.data))return Mt(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return Ct.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function Lt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function Ht(t){return Lt(t),kt(t<0?0:0|_t(t))}function Mt(t){for(var e=t.length<0?0:0|_t(t.length),r=kt(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function Zt(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,Ct.prototype),n}function _t(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function $t(t,e){if(Ct.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||le(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return ue(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return he(t).length;default:if(i)return n?-1:ue(t).length;e=(""+e).toLowerCase(),i=!0}}function Wt(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return ee(this,e,r);case"utf8":case"utf-8":return Xt(this,e,r);case"ascii":return Qt(this,e,r);case"latin1":case"binary":return te(this,e,r);case"base64":return Jt(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function Dt(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Kt(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),pe(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=Ct.from(e,n)),Ct.isBuffer(e))return 0===e.length?-1:Vt(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Vt(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Vt(t,e,r,n,i){var o,f=1,s=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;f=2,s/=2,a/=2,r/=2}function u(t,e){return 1===f?t[e]:t.readUInt16BE(e*f)}if(i){var h=-1;for(o=r;o<s;o++)if(u(t,o)===u(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===a)return h*f}else-1!==h&&(o-=o-h),h=-1}else for(r+a>s&&(r=s-a),o=r;o>=0;o--){for(var c=!0,l=0;l<a;l++)if(u(t,o+l)!==u(e,l)){c=!1;break}if(c)return o}return-1}function jt(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var f=0;f<n;++f){var s=parseInt(e.substr(2*f,2),16);if(pe(s))return f;t[r+f]=s}return f}function Gt(t,e,r,n){return ce(ue(e,t.length-r),t,r,n)}function Ft(t,e,r,n){return ce(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function qt(t,e,r,n){return ce(he(e),t,r,n)}function Yt(t,e,r,n){return ce(function(t,e){for(var r,n,i,o=[],f=0;f<t.length&&!((e-=2)<0);++f)n=(r=t.charCodeAt(f))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function Jt(t,e,r){return 0===e&&r===t.length?vt(t):vt(t.slice(e,r))}function Xt(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,f,s,a,u=t[i],h=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=r)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(o=t[i+1]))&&(a=(31&u)<<6|63&o)>127&&(h=a);break;case 3:o=t[i+1],f=t[i+2],128==(192&o)&&128==(192&f)&&(a=(15&u)<<12|(63&o)<<6|63&f)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:o=t[i+1],f=t[i+2],s=t[i+3],128==(192&o)&&128==(192&f)&&128==(192&s)&&(a=(15&u)<<18|(63&o)<<12|(63&f)<<6|63&s)>65535&&a<1114112&&(h=a)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}Ct.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),Ct.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Ct.prototype,"parent",{enumerable:!0,get:function(){if(Ct.isBuffer(this))return this.buffer}}),Object.defineProperty(Ct.prototype,"offset",{enumerable:!0,get:function(){if(Ct.isBuffer(this))return this.byteOffset}}),Ct.poolSize=8192,Ct.from=function(t,e,r){return Nt(t,e,r)},Object.setPrototypeOf(Ct.prototype,Uint8Array.prototype),Object.setPrototypeOf(Ct,Uint8Array),Ct.alloc=function(t,e,r){return function(t,e,r){return Lt(t),t<=0?kt(t):void 0!==e?"string"==typeof r?kt(t).fill(e,r):kt(t).fill(e):kt(t)}(t,e,r)},Ct.allocUnsafe=function(t){return Ht(t)},Ct.allocUnsafeSlow=function(t){return Ht(t)},Ct.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==Ct.prototype},Ct.compare=function(t,e){if(le(t,Uint8Array)&&(t=Ct.from(t,t.offset,t.byteLength)),le(e,Uint8Array)&&(e=Ct.from(e,e.offset,e.byteLength)),!Ct.isBuffer(t)||!Ct.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},Ct.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ct.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Ct.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=Ct.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(le(o,Uint8Array))i+o.length>n.length?Ct.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!Ct.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},Ct.byteLength=$t,Ct.prototype._isBuffer=!0,Ct.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Dt(this,e,e+1);return this},Ct.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Dt(this,e,e+3),Dt(this,e+1,e+2);return this},Ct.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Dt(this,e,e+7),Dt(this,e+1,e+6),Dt(this,e+2,e+5),Dt(this,e+3,e+4);return this},Ct.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?Xt(this,0,t):Wt.apply(this,arguments)},Ct.prototype.toLocaleString=Ct.prototype.toString,Ct.prototype.equals=function(t){if(!Ct.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Ct.compare(this,t)},Ct.prototype.inspect=function(){var t="";return t=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(t+=" ... "),"<Buffer "+t+">"},zt&&(Ct.prototype[zt]=Ct.prototype.inspect),Ct.prototype.compare=function(t,e,r,n,i){if(le(t,Uint8Array)&&(t=Ct.from(t,t.offset,t.byteLength)),!Ct.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),f=(r>>>=0)-(e>>>=0),s=Math.min(o,f),a=this.slice(n,i),u=t.slice(e,r),h=0;h<s;++h)if(a[h]!==u[h]){o=a[h],f=u[h];break}return o<f?-1:f<o?1:0},Ct.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Ct.prototype.indexOf=function(t,e,r){return Kt(this,t,e,r,!0)},Ct.prototype.lastIndexOf=function(t,e,r){return Kt(this,t,e,r,!1)},Ct.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return jt(this,t,e,r);case"utf8":case"utf-8":return Gt(this,t,e,r);case"ascii":case"latin1":case"binary":return Ft(this,t,e,r);case"base64":return qt(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Yt(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Ct.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Qt(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function te(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function ee(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=ye[t[o]];return i}function re(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function ne(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function ie(t,e,r,n,i,o){if(!Ct.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function oe(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function fe(t,e,r,n,i){return e=+e,r>>>=0,i||oe(t,0,r,4),At(t,e,r,n,23,4),r+4}function se(t,e,r,n,i){return e=+e,r>>>=0,i||oe(t,0,r,8),At(t,e,r,n,52,8),r+8}Ct.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,Ct.prototype),n},Ct.prototype.readUintLE=Ct.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||ne(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},Ct.prototype.readUintBE=Ct.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||ne(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Ct.prototype.readUint8=Ct.prototype.readUInt8=function(t,e){return t>>>=0,e||ne(t,1,this.length),this[t]},Ct.prototype.readUint16LE=Ct.prototype.readUInt16LE=function(t,e){return t>>>=0,e||ne(t,2,this.length),this[t]|this[t+1]<<8},Ct.prototype.readUint16BE=Ct.prototype.readUInt16BE=function(t,e){return t>>>=0,e||ne(t,2,this.length),this[t]<<8|this[t+1]},Ct.prototype.readUint32LE=Ct.prototype.readUInt32LE=function(t,e){return t>>>=0,e||ne(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Ct.prototype.readUint32BE=Ct.prototype.readUInt32BE=function(t,e){return t>>>=0,e||ne(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Ct.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||ne(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},Ct.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||ne(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},Ct.prototype.readInt8=function(t,e){return t>>>=0,e||ne(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Ct.prototype.readInt16LE=function(t,e){t>>>=0,e||ne(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Ct.prototype.readInt16BE=function(t,e){t>>>=0,e||ne(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Ct.prototype.readInt32LE=function(t,e){return t>>>=0,e||ne(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Ct.prototype.readInt32BE=function(t,e){return t>>>=0,e||ne(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Ct.prototype.readFloatLE=function(t,e){return t>>>=0,e||ne(t,4,this.length),Bt(this,t,!0,23,4)},Ct.prototype.readFloatBE=function(t,e){return t>>>=0,e||ne(t,4,this.length),Bt(this,t,!1,23,4)},Ct.prototype.readDoubleLE=function(t,e){return t>>>=0,e||ne(t,8,this.length),Bt(this,t,!0,52,8)},Ct.prototype.readDoubleBE=function(t,e){return t>>>=0,e||ne(t,8,this.length),Bt(this,t,!1,52,8)},Ct.prototype.writeUintLE=Ct.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||ie(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},Ct.prototype.writeUintBE=Ct.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||ie(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},Ct.prototype.writeUint8=Ct.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,1,255,0),this[e]=255&t,e+1},Ct.prototype.writeUint16LE=Ct.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},Ct.prototype.writeUint16BE=Ct.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},Ct.prototype.writeUint32LE=Ct.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},Ct.prototype.writeUint32BE=Ct.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Ct.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);ie(this,t,e,r,i-1,-i)}var o=0,f=1,s=0;for(this[e]=255&t;++o<r&&(f*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/f>>0)-s&255;return e+r},Ct.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);ie(this,t,e,r,i-1,-i)}var o=r-1,f=1,s=0;for(this[e+o]=255&t;--o>=0&&(f*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/f>>0)-s&255;return e+r},Ct.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},Ct.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},Ct.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},Ct.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},Ct.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||ie(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Ct.prototype.writeFloatLE=function(t,e,r){return fe(this,t,e,!0,r)},Ct.prototype.writeFloatBE=function(t,e,r){return fe(this,t,e,!1,r)},Ct.prototype.writeDoubleLE=function(t,e,r){return se(this,t,e,!0,r)},Ct.prototype.writeDoubleBE=function(t,e,r){return se(this,t,e,!1,r)},Ct.prototype.copy=function(t,e,r,n){if(!Ct.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},Ct.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Ct.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var f=Ct.isBuffer(t)?t:Ct.from(t,n),s=f.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=f[o%s]}return this};var ae=/[^+/0-9A-Za-z-_]/g;function ue(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],f=0;f<n;++f){if((r=t.charCodeAt(f))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(f+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function he(t){return Et(function(t){if((t=(t=t.split("=")[0]).trim().replace(ae,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function ce(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function le(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function pe(t){return t!=t}var ye=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}(),ge=bt;async function de(){const t=N.randomPrivateKey(),e=await async function(t){return(await y.fromPrivateKey(t)).toRawBytes()}(t);return{privateKey:t,publicKey:e}}function we(){const t=mt.randomPrivateKey(),e=function(t,e=!1){return G.fromPrivateKey(t).toRawBytes(e)}(t);return{privateKey:t,publicKey:e}}function me(t){return ge.from(t).toString("hex")}!async function(){console.log("Testing"),console.log("RANDOM KEY",N.randomPrivateKey());const{privateKey:t,publicKey:e}=await de();document.getElementById("ed25519-public-key").innerText=me(e),document.getElementById("ed25519-private-key").innerText=me(t);const{privateKey:r,publicKey:n}=we();document.getElementById("secp256k1-public-key").innerText=me(r),document.getElementById("secp256k1-private-key").innerText=me(n)}();
//# sourceMappingURL=index.61dbf098.js.map
